/**
 * Module      : Test_SHA512.mo
 * Description : Unit tests.
 * Copyright   : 2021 DFINITY Stiftung
 * License     : Apache 2.0 with LLVM Exception
 * Maintainer  : Enzo Haussecker <enzo@dfinity.org>
 * Stability   : Stable
 */

import Array "mo:base/Array";
import SHA512 "../src/SHA512";

type Test = {
  data : [Nat8];
  expect : [Nat8];
};

let tests = [
  {
    data = [
    ] : [Nat8];
    expect = [
      207, 131, 225, 053, 126, 239, 184, 189,
      241, 084, 040, 080, 214, 109, 128, 007,
      214, 032, 228, 005, 011, 087, 021, 220,
      131, 244, 169, 033, 211, 108, 233, 206,
      071, 208, 209, 060, 093, 133, 242, 176,
      255, 131, 024, 210, 135, 126, 236, 047,
      099, 185, 049, 189, 071, 065, 122, 129,
      165, 056, 050, 122, 249, 039, 218, 062
    ] : [Nat8];
  },
  {
    data = [
      097
    ] : [Nat8];
    expect = [
      031, 064, 252, 146, 218, 036, 022, 148,
      117, 009, 121, 238, 108, 245, 130, 242,
      213, 215, 210, 142, 024, 051, 093, 224,
      090, 188, 084, 208, 086, 014, 015, 083,
      002, 134, 012, 101, 043, 240, 141, 086,
      002, 082, 170, 094, 116, 033, 005, 070,
      243, 105, 251, 187, 206, 140, 018, 207,
      199, 149, 123, 038, 082, 254, 154, 117
    ] : [Nat8];
  },
  {
    data = [
      097, 098
    ] : [Nat8];
    expect = [
      045, 064, 138, 007, 023, 236, 024, 129,
      088, 039, 138, 121, 108, 104, 144, 068,
      054, 029, 198, 253, 222, 040, 214, 240,
      073, 115, 184, 008, 150, 225, 130, 057,
      117, 205, 191, 018, 235, 099, 249, 224,
      089, 019, 040, 238, 035, 093, 128, 233,
      181, 191, 026, 166, 164, 079, 070, 023,
      255, 060, 175, 100, 000, 235, 023, 045
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099
    ] : [Nat8];
    expect = [
      221, 175, 053, 161, 147, 097, 122, 186,
      204, 065, 115, 073, 174, 032, 065, 049,
      018, 230, 250, 078, 137, 169, 126, 162,
      010, 158, 238, 230, 075, 085, 211, 154,
      033, 146, 153, 042, 039, 079, 193, 168,
      054, 186, 060, 035, 163, 254, 235, 189,
      069, 077, 068, 035, 100, 060, 232, 014,
      042, 154, 201, 079, 165, 076, 164, 159
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100
    ] : [Nat8];
    expect = [
      216, 002, 047, 032, 096, 173, 110, 253,
      041, 122, 183, 061, 204, 083, 085, 201,
      178, 020, 005, 075, 013, 023, 118, 161,
      054, 166, 105, 210, 106, 125, 059, 020,
      247, 058, 160, 208, 235, 255, 025, 238,
      051, 051, 104, 240, 022, 075, 100, 025,
      169, 109, 164, 158, 062, 072, 023, 083,
      231, 233, 107, 113, 107, 220, 203, 111
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101
    ] : [Nat8];
    expect = [
      135, 138, 230, 090, 146, 232, 108, 172,
      001, 026, 087, 013, 076, 048, 167, 234,
      236, 068, 043, 133, 206, 142, 202, 012,
      041, 082, 181, 227, 204, 006, 040, 194,
      231, 157, 136, 154, 212, 213, 199, 198,
      038, 152, 109, 069, 045, 216, 099, 116,
      182, 255, 170, 124, 216, 182, 118, 101,
      190, 242, 040, 154, 092, 112, 176, 161
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101, 102
    ] : [Nat8];
    expect = [
      227, 046, 241, 150, 035, 232, 237, 157,
      038, 127, 101, 122, 129, 148, 075, 061,
      007, 173, 187, 118, 133, 024, 006, 142,
      136, 067, 087, 069, 086, 078, 141, 065,
      080, 160, 167, 003, 190, 042, 125, 136,
      182, 030, 061, 057, 012, 043, 185, 126,
      045, 076, 049, 031, 220, 105, 214, 177,
      038, 127, 005, 245, 154, 169, 032, 231
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101, 102, 103
    ] : [Nat8];
    expect = [
      215, 022, 164, 024, 133, 105, 182, 138,
      177, 182, 223, 172, 023, 142, 087, 001,
      020, 205, 240, 234, 058, 028, 192, 227,
      020, 134, 195, 228, 018, 065, 188, 106,
      118, 066, 078, 140, 055, 171, 038, 240,
      150, 252, 133, 239, 152, 134, 200, 203,
      099, 065, 135, 244, 253, 223, 246, 069,
      251, 009, 159, 031, 245, 076, 107, 140
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101, 102, 103, 104
    ] : [Nat8];
    expect = [
      163, 168, 200, 027, 201, 124, 037, 096,
      001, 013, 115, 137, 188, 136, 170, 201,
      116, 161, 004, 224, 226, 056, 018, 032,
      198, 224, 132, 196, 220, 205, 029, 045,
      023, 212, 248, 109, 179, 028, 042, 133,
      029, 200, 014, 102, 129, 215, 071, 051,
      197, 093, 205, 003, 221, 150, 246, 006,
      044, 221, 161, 042, 041, 026, 230, 206
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101, 102, 103, 104,
      105
    ] : [Nat8];
    expect = [
      242, 045, 081, 210, 082, 146, 202, 029,
      015, 104, 246, 154, 237, 199, 137, 112,
      025, 048, 140, 201, 219, 070, 239, 183,
      090, 003, 221, 073, 079, 199, 241, 038,
      192, 016, 232, 173, 230, 160, 010, 012,
      026, 095, 027, 117, 216, 030, 014, 213,
      169, 060, 233, 141, 201, 184, 051, 219,
      120, 057, 036, 123, 029, 156, 036, 254
    ] : [Nat8];
  },
  {
    data = [
      097, 098, 099, 100, 101, 102, 103, 104,
      105, 106
    ] : [Nat8];
    expect = [
      239, 107, 151, 050, 031, 052, 177, 254,
      162, 022, 154, 125, 185, 225, 150, 011,
      071, 026, 161, 051, 002, 169, 136, 008,
      115, 087, 197, 032, 190, 149, 124, 161,
      025, 195, 186, 104, 230, 180, 152, 044,
      001, 158, 200, 157, 227, 134, 092, 207,
      106, 060, 218, 031, 225, 030, 089, 249,
      141, 153, 241, 080, 044, 139, 151, 069
    ] : [Nat8];
  },
  {
    data = [
      068, 105, 115, 099, 097, 114, 100, 032,
      109, 101, 100, 105, 099, 105, 110, 101,
      032, 109, 111, 114, 101, 032, 116, 104,
      097, 110, 032, 116, 119, 111, 032, 121,
      101, 097, 114, 115, 032, 111, 108, 100,
      046
    ] : [Nat8];
    expect = [
      034, 016, 217, 154, 249, 200, 189, 236,
      218, 027, 075, 239, 248, 034, 019, 103,
      083, 216, 052, 037, 005, 221, 206, 055,
      241, 049, 078, 044, 219, 180, 136, 198,
      001, 107, 218, 169, 189, 047, 250, 081,
      061, 213, 222, 046, 075, 080, 240, 049,
      057, 061, 138, 182, 031, 119, 059, 014,
      001, 048, 215, 056, 030, 015, 138, 029
    ] : [Nat8];
  },
  {
    data = [
      072, 101, 032, 119, 104, 111, 032, 104,
      097, 115, 032, 097, 032, 115, 104, 097,
      100, 121, 032, 112, 097, 115, 116, 032,
      107, 110, 111, 119, 115, 032, 116, 104,
      097, 116, 032, 110, 105, 099, 101, 032,
      103, 117, 121, 115, 032, 102, 105, 110,
      105, 115, 104, 032, 108, 097, 115, 116,
      046
    ] : [Nat8];
    expect = [
      166, 135, 168, 152, 091, 077, 141, 010,
      036, 241, 021, 254, 039, 034, 085, 198,
      175, 175, 057, 009, 034, 088, 056, 084,
      097, 089, 193, 237, 104, 092, 033, 026,
      032, 055, 150, 174, 142, 204, 076, 129,
      165, 182, 049, 089, 025, 179, 166, 079,
      016, 113, 061, 160, 126, 052, 031, 205,
      187, 008, 084, 027, 240, 048, 102, 206
    ] : [Nat8];
  },
  {
    data = [
      073, 032, 119, 111, 117, 108, 100, 110,
      039, 116, 032, 109, 097, 114, 114, 121,
      032, 104, 105, 109, 032, 119, 105, 116,
      104, 032, 097, 032, 116, 101, 110, 032,
      102, 111, 111, 116, 032, 112, 111, 108,
      101, 046
    ] : [Nat8];
    expect = [
      141, 219, 003, 146, 232, 024, 183, 213,
      133, 171, 034, 118, 154, 080, 223, 102,
      013, 159, 109, 085, 156, 202, 058, 252,
      086, 145, 184, 202, 145, 184, 069, 019,
      116, 228, 043, 205, 171, 214, 069, 137,
      237, 124, 145, 216, 095, 098, 101, 150,
      034, 138, 092, 133, 114, 103, 126, 185,
      139, 198, 182, 036, 190, 251, 122, 248
    ] : [Nat8];
  },
  {
    data = [
      070, 114, 101, 101, 033, 032, 070, 114,
      101, 101, 033, 047, 065, 032, 116, 114,
      105, 112, 047, 116, 111, 032, 077, 097,
      114, 115, 047, 102, 111, 114, 032, 057,
      048, 048, 047, 101, 109, 112, 116, 121,
      032, 106, 097, 114, 115, 047, 066, 117,
      114, 109, 097, 032, 083, 104, 097, 118,
      101
    ] : [Nat8];
    expect = [
      038, 237, 143, 108, 167, 248, 212, 075,
      106, 138, 084, 174, 057, 100, 015, 168,
      173, 092, 103, 063, 112, 238, 156, 224,
      116, 186, 078, 240, 212, 131, 238, 160,
      011, 171, 047, 097, 216, 105, 093, 107,
      052, 223, 156, 108, 072, 174, 054, 036,
      099, 098, 032, 014, 216, 032, 068, 139,
      220, 003, 167, 032, 054, 106, 135, 198
    ] : [Nat8];
  },
  {
    data = [
      084, 104, 101, 032, 100, 097, 121, 115,
      032, 111, 102, 032, 116, 104, 101, 032,
      100, 105, 103, 105, 116, 097, 108, 032,
      119, 097, 116, 099, 104, 032, 097, 114,
      101, 032, 110, 117, 109, 098, 101, 114,
      101, 100, 046, 032, 032, 045, 084, 111,
      109, 032, 083, 116, 111, 112, 112, 097,
      114, 100
    ] : [Nat8];
    expect = [
      229, 161, 075, 240, 068, 190, 105, 097,
      090, 173, 232, 154, 252, 241, 171, 003,
      137, 213, 252, 048, 042, 136, 077, 064,
      053, 121, 209, 056, 106, 036, 000, 192,
      137, 176, 219, 179, 135, 237, 015, 070,
      063, 158, 227, 066, 248, 036, 077, 090,
      056, 207, 188, 014, 129, 157, 169, 082,
      159, 191, 247, 131, 104, 201, 169, 130
    ] : [Nat8];
  },
  {
    data = [
      078, 101, 112, 097, 108, 032, 112, 114,
      101, 109, 105, 101, 114, 032, 119, 111,
      110, 039, 116, 032, 114, 101, 115, 105,
      103, 110, 046
    ] : [Nat8];
    expect = [
      066, 010, 031, 170, 072, 145, 158, 020,
      101, 027, 237, 069, 114, 090, 190, 015,
      122, 088, 224, 240, 153, 066, 076, 078,
      090, 073, 025, 073, 070, 227, 139, 070,
      193, 248, 003, 075, 024, 239, 022, 155,
      046, 049, 005, 013, 022, 072, 224, 185,
      130, 056, 101, 149, 247, 223, 071, 218,
      075, 111, 209, 142, 085, 051, 048, 021
    ] : [Nat8];
  },
  {
    data = [
      070, 111, 114, 032, 101, 118, 101, 114,
      121, 032, 097, 099, 116, 105, 111, 110,
      032, 116, 104, 101, 114, 101, 032, 105,
      115, 032, 097, 110, 032, 101, 113, 117,
      097, 108, 032, 097, 110, 100, 032, 111,
      112, 112, 111, 115, 105, 116, 101, 032,
      103, 111, 118, 101, 114, 110, 109, 101,
      110, 116, 032, 112, 114, 111, 103, 114,
      097, 109, 046
    ] : [Nat8];
    expect = [
      217, 038, 168, 099, 190, 173, 178, 001,
      052, 219, 007, 104, 053, 053, 199, 032,
      007, 176, 230, 149, 004, 088, 118, 037,
      079, 052, 029, 220, 204, 222, 019, 042,
      144, 140, 090, 245, 123, 170, 106, 106,
      156, 099, 230, 100, 155, 186, 012, 033,
      061, 192, 095, 173, 207, 154, 188, 206,
      160, 159, 035, 220, 251, 099, 127, 190
    ] : [Nat8];
  },
  {
    data = [
      072, 105, 115, 032, 109, 111, 110, 101,
      121, 032, 105, 115, 032, 116, 119, 105,
      099, 101, 032, 116, 097, 105, 110, 116,
      101, 100, 058, 032, 039, 116, 097, 105,
      110, 116, 032, 121, 111, 117, 114, 115,
      032, 097, 110, 100, 032, 039, 116, 097,
      105, 110, 116, 032, 109, 105, 110, 101,
      046
    ] : [Nat8];
    expect = [
      154, 152, 221, 155, 182, 125, 013, 167,
      191, 131, 218, 083, 019, 223, 244, 253,
      096, 164, 186, 192, 009, 079, 027, 005,
      099, 054, 144, 255, 167, 246, 214, 029,
      233, 161, 212, 248, 097, 121, 055, 213,
      096, 131, 058, 154, 170, 156, 202, 254,
      063, 210, 077, 180, 024, 208, 231, 040,
      131, 053, 069, 202, 221, 058, 217, 045
    ] : [Nat8];
  },
  {
    data = [
      084, 104, 101, 114, 101, 032, 105, 115,
      032, 110, 111, 032, 114, 101, 097, 115,
      111, 110, 032, 102, 111, 114, 032, 097,
      110, 121, 032, 105, 110, 100, 105, 118,
      105, 100, 117, 097, 108, 032, 116, 111,
      032, 104, 097, 118, 101, 032, 097, 032,
      099, 111, 109, 112, 117, 116, 101, 114,
      032, 105, 110, 032, 116, 104, 101, 105,
      114, 032, 104, 111, 109, 101, 046, 032,
      045, 075, 101, 110, 032, 079, 108, 115,
      101, 110, 044, 032, 049, 057, 055, 055
    ] : [Nat8];
    expect = [
      215, 253, 226, 210, 053, 030, 250, 222,
      082, 244, 033, 029, 055, 070, 160, 120,
      010, 038, 238, 195, 223, 155, 046, 213,
      117, 054, 138, 138, 028, 009, 236, 069,
      036, 002, 041, 058, 142, 164, 236, 235,
      090, 079, 096, 006, 078, 162, 155, 019,
      205, 216, 105, 024, 205, 122, 079, 175,
      054, 097, 096, 176, 009, 128, 065, 007
    ] : [Nat8];
  },
  {
    data = [
      073, 116, 039, 115, 032, 097, 032, 116,
      105, 110, 121, 032, 099, 104, 097, 110,
      103, 101, 032, 116, 111, 032, 116, 104,
      101, 032, 099, 111, 100, 101, 032, 097,
      110, 100, 032, 110, 111, 116, 032, 099,
      111, 109, 112, 108, 101, 116, 101, 108,
      121, 032, 100, 105, 115, 103, 117, 115,
      116, 105, 110, 103, 046, 032, 045, 032,
      066, 111, 098, 032, 077, 097, 110, 099,
      104, 101, 107
    ] : [Nat8];
    expect = [
      176, 243, 095, 250, 038, 151, 053, 156,
      051, 165, 111, 092, 012, 247, 021, 199,
      174, 237, 150, 218, 153, 005, 202, 038,
      152, 172, 173, 176, 143, 188, 158, 102,
      155, 245, 102, 182, 189, 093, 097, 163,
      232, 109, 194, 041, 153, 188, 201, 242,
      034, 078, 051, 209, 212, 243, 042, 034,
      140, 249, 208, 052, 158, 045, 181, 024
    ] : [Nat8];
  },
  {
    data = [
      115, 105, 122, 101, 058, 032, 032, 097,
      046, 111, 117, 116, 058, 032, 032, 098,
      097, 100, 032, 109, 097, 103, 105, 099
    ] : [Nat8];
    expect = [
      061, 046, 095, 145, 119, 140, 158, 102,
      247, 224, 097, 041, 058, 170, 138, 143,
      199, 066, 221, 059, 046, 079, 072, 055,
      114, 070, 075, 017, 068, 024, 155, 073,
      039, 062, 097, 014, 092, 204, 215, 168,
      026, 025, 202, 031, 167, 015, 022, 177,
      015, 026, 016, 010, 077, 140, 019, 114,
      051, 107, 232, 072, 076, 100, 179, 017
    ] : [Nat8];
  },
  {
    data = [
      084, 104, 101, 032, 109, 097, 106, 111,
      114, 032, 112, 114, 111, 098, 108, 101,
      109, 032, 105, 115, 032, 119, 105, 116,
      104, 032, 115, 101, 110, 100, 109, 097,
      105, 108, 046, 032, 032, 045, 077, 097,
      114, 107, 032, 072, 111, 114, 116, 111,
      110
    ] : [Nat8];
    expect = [
      178, 246, 143, 245, 138, 192, 021, 239,
      177, 201, 076, 144, 139, 013, 140, 043,
      240, 111, 073, 030, 077, 232, 230, 048,
      044, 073, 001, 111, 127, 138, 051, 234,
      195, 233, 089, 133, 108, 127, 221, 188,
      070, 077, 230, 024, 112, 019, 056, 164,
      180, 111, 118, 219, 250, 249, 161, 229,
      038, 043, 095, 064, 099, 151, 113, 199
    ] : [Nat8];
  },
  {
    data = [
      071, 105, 118, 101, 032, 109, 101, 032,
      097, 032, 114, 111, 099, 107, 044, 032,
      112, 097, 112, 101, 114, 032, 097, 110,
      100, 032, 115, 099, 105, 115, 115, 111,
      114, 115, 032, 097, 110, 100, 032, 073,
      032, 119, 105, 108, 108, 032, 109, 111,
      118, 101, 032, 116, 104, 101, 032, 119,
      111, 114, 108, 100, 046, 032, 032, 067,
      067, 070, 101, 115, 116, 111, 111, 110
    ] : [Nat8];
    expect = [
      216, 201, 045, 181, 253, 245, 044, 248,
      033, 094, 077, 243, 180, 144, 157, 041,
      032, 063, 244, 208, 014, 154, 208, 182,
      074, 106, 078, 004, 222, 197, 231, 079,
      098, 231, 195, 092, 127, 184, 129, 189,
      093, 233, 084, 066, 018, 061, 248, 245,
      122, 072, 155, 010, 230, 022, 189, 050,
      111, 132, 209, 000, 033, 018, 028, 087
    ] : [Nat8];
  },
  {
    data = [
      073, 102, 032, 116, 104, 101, 032, 101,
      110, 101, 109, 121, 032, 105, 115, 032,
      119, 105, 116, 104, 105, 110, 032, 114,
      097, 110, 103, 101, 044, 032, 116, 104,
      101, 110, 032, 115, 111, 032, 097, 114,
      101, 032, 121, 111, 117, 046
    ] : [Nat8];
    expect = [
      025, 169, 248, 220, 010, 035, 062, 070,
      078, 133, 102, 173, 060, 169, 185, 030,
      069, 154, 123, 140, 071, 128, 152, 091,
      001, 087, 118, 225, 191, 035, 154, 025,
      188, 035, 061, 005, 086, 052, 062, 043,
      010, 155, 194, 032, 144, 011, 078, 191,
      079, 139, 223, 137, 255, 142, 254, 175,
      121, 096, 045, 104, 073, 230, 247, 046
    ] : [Nat8];
  },
  {
    data = [
      073, 116, 039, 115, 032, 119, 101, 108,
      108, 032, 119, 101, 032, 099, 097, 110,
      110, 111, 116, 032, 104, 101, 097, 114,
      032, 116, 104, 101, 032, 115, 099, 114,
      101, 097, 109, 115, 047, 084, 104, 097,
      116, 032, 119, 101, 032, 099, 114, 101,
      097, 116, 101, 032, 105, 110, 032, 111,
      116, 104, 101, 114, 115, 039, 032, 100,
      114, 101, 097, 109, 115, 046
    ] : [Nat8];
    expect = [
      000, 180, 196, 031, 048, 123, 222, 135,
      048, 028, 220, 091, 090, 177, 174, 154,
      089, 046, 142, 203, 178, 002, 029, 215,
      188, 075, 052, 226, 172, 230, 007, 065,
      204, 054, 037, 096, 190, 197, 102, 186,
      053, 023, 133, 149, 169, 025, 050, 184,
      213, 053, 126, 044, 156, 236, 146, 211,
      147, 176, 250, 120, 049, 133, 036, 118
    ] : [Nat8];
  },
  {
    data = [
      089, 111, 117, 032, 114, 101, 109, 105,
      110, 100, 032, 109, 101, 032, 111, 102,
      032, 097, 032, 084, 086, 032, 115, 104,
      111, 119, 044, 032, 098, 117, 116, 032,
      116, 104, 097, 116, 039, 115, 032, 097,
      108, 108, 032, 114, 105, 103, 104, 116,
      058, 032, 073, 032, 119, 097, 116, 099,
      104, 032, 105, 116, 032, 097, 110, 121,
      119, 097, 121, 046
    ] : [Nat8];
    expect = [
      145, 236, 204, 061, 083, 117, 253, 002,
      110, 077, 103, 135, 135, 075, 029, 206,
      032, 028, 236, 216, 162, 125, 189, 237,
      080, 101, 114, 140, 178, 208, 156, 088,
      163, 212, 103, 187, 031, 175, 053, 059,
      247, 186, 086, 126, 000, 082, 069, 213,
      050, 027, 085, 188, 052, 079, 124, 007,
      185, 028, 182, 242, 108, 149, 155, 231
    ] : [Nat8];
  },
  {
    data = [
      067, 032, 105, 115, 032, 097, 115, 032,
      112, 111, 114, 116, 097, 098, 108, 101,
      032, 097, 115, 032, 083, 116, 111, 110,
      101, 104, 101, 100, 103, 101, 033, 033
    ] : [Nat8];
    expect = [
      250, 187, 190, 034, 024, 015, 031, 019,
      124, 253, 201, 085, 109, 037, 112, 231,
      117, 209, 174, 002, 165, 151, 222, 212,
      058, 114, 164, 015, 155, 072, 093, 080,
      000, 067, 183, 190, 018, 143, 185, 252,
      217, 130, 184, 049, 089, 160, 217, 154,
      168, 085, 169, 231, 204, 066, 064, 192,
      013, 192, 026, 155, 223, 130, 024, 215
    ] : [Nat8];
  },
  {
    data = [
      069, 118, 101, 110, 032, 105, 102, 032,
      073, 032, 099, 111, 117, 108, 100, 032,
      098, 101, 032, 083, 104, 097, 107, 101,
      115, 112, 101, 097, 114, 101, 044, 032,
      073, 032, 116, 104, 105, 110, 107, 032,
      073, 032, 115, 104, 111, 117, 108, 100,
      032, 115, 116, 105, 108, 108, 032, 099,
      104, 111, 111, 115, 101, 032, 116, 111,
      032, 098, 101, 032, 070, 097, 114, 097,
      100, 097, 121, 046, 032, 045, 032, 065,
      046, 032, 072, 117, 120, 108, 101, 121
    ] : [Nat8];
    expect = [
      046, 205, 236, 035, 092, 031, 164, 252,
      042, 021, 077, 143, 186, 029, 221, 184,
      167, 042, 026, 215, 056, 056, 181, 029,
      121, 035, 049, 209, 067, 248, 185, 106,
      159, 111, 203, 015, 052, 215, 202, 163,
      081, 254, 109, 136, 119, 028, 079, 016,
      080, 064, 224, 057, 047, 006, 224, 098,
      022, 137, 211, 059, 047, 059, 169, 046
    ] : [Nat8];
  },
  {
    data = [
      084, 104, 101, 032, 102, 117, 103, 097,
      099, 105, 116, 121, 032, 111, 102, 032,
      097, 032, 099, 111, 110, 115, 116, 105,
      116, 117, 101, 110, 116, 032, 105, 110,
      032, 097, 032, 109, 105, 120, 116, 117,
      114, 101, 032, 111, 102, 032, 103, 097,
      115, 101, 115, 032, 097, 116, 032, 097,
      032, 103, 105, 118, 101, 110, 032, 116,
      101, 109, 112, 101, 114, 097, 116, 117,
      114, 101, 032, 105, 115, 032, 112, 114,
      111, 112, 111, 114, 116, 105, 111, 110,
      097, 108, 032, 116, 111, 032, 105, 116,
      115, 032, 109, 111, 108, 101, 032, 102,
      114, 097, 099, 116, 105, 111, 110, 046,
      032, 032, 076, 101, 119, 105, 115, 045,
      082, 097, 110, 100, 097, 108, 108, 032,
      082, 117, 108, 101
    ] : [Nat8];
    expect = [
      122, 214, 129, 246, 249, 111, 130, 247,
      171, 250, 126, 204, 003, 052, 232, 250,
      022, 211, 220, 028, 220, 069, 182, 011,
      122, 244, 063, 228, 007, 093, 035, 087,
      192, 193, 214, 014, 152, 053, 015, 026,
      251, 031, 047, 231, 164, 215, 205, 042,
      213, 091, 136, 228, 088, 224, 107, 115,
      196, 011, 067, 115, 049, 245, 218, 180
    ] : [Nat8];
  },
  {
    data = [
      072, 111, 119, 032, 099, 097, 110, 032,
      121, 111, 117, 032, 119, 114, 105, 116,
      101, 032, 097, 032, 098, 105, 103, 032,
      115, 121, 115, 116, 101, 109, 032, 119,
      105, 116, 104, 111, 117, 116, 032, 067,
      043, 043, 063, 032, 032, 045, 080, 097,
      117, 108, 032, 071, 108, 105, 099, 107
    ] : [Nat8];
    expect = [
      131, 063, 146, 072, 171, 074, 059, 158,
      081, 049, 247, 069, 253, 161, 255, 210,
      221, 067, 091, 048, 233, 101, 149, 126,
      120, 041, 028, 122, 183, 054, 005, 253,
      025, 018, 176, 121, 078, 092, 035, 058,
      176, 161, 045, 032, 090, 057, 119, 141,
      025, 184, 053, 021, 214, 164, 112, 003,
      241, 156, 222, 229, 029, 152, 199, 224
    ] : [Nat8];
  },
];

func eq(a : Nat8, b : Nat8) : Bool {
  return a == b;
};

for (test in tests.vals()) {
  let expect = test.expect;
  let actual = SHA512.sha512(test.data);
  assert(Array.equal<Nat8>(expect, actual, eq));
};
